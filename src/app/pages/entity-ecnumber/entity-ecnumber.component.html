<div class="flex flex-col gap-4 max-w-content-xl w-full px-4">
  <div class="flex items-center justify-between pt-10">
    <div class="flex gap-2 items-center">
      <button type="button" title="Back to Search"
        class="border border-solid border-[#DEE2E6] rounded-sm px-2 py-1 flex items-center gap-2 bg-[#f8f9fa]"
        (click)="backToSearch()">
        <i class="pi pi-arrow-left"></i>
        <span>Back to Search</span>
      </button>
      @if (ec) {
        <h5 class="font-bold mt-0">EC Number: {{ ec['entry'] }}</h5>
      }
    </div>
    <div class="flex items-center gap-2">

      <div id="btn-export" class="flex flex-col justify-center">
        <p-button label="Export" icon="pi pi-download" (onClick)="menu.toggle($event)"></p-button>
        <p-tieredMenu #menu [model]="exportOptions" [popup]="true" />
      </div>
    </div>
  </div>

  <p-panel>
    <ng-template pTemplate="header">
      <span class="grow">Overview</span>
    </ng-template>

    @if (ec) {
    <div class="flex gap-2 p-2">
      <div class="flex flex-col gap-4 w-1/3 border-r border-solid border-[#DEE2E6] p-2">
        <div class="flex flex-col gap-4">
          <p class="font-bold">Entity Information</p>
          <div class="flex justify-between">
            <span class="leading-sm text-[#495057]">EC Number</span>
            <span class="font-semibold text-end leading-base inline-block max-w-[200px] break-words">{{ ec['entry'] }}</span>
          </div>
          <div class="flex justify-between">
            <span class="leading-sm text-[#495057]">Generic Name</span>
            <span class="font-semibold text-end leading-base inline-block max-w-[200px] break-words">{{ ec['name'][0] }}</span>
          </div>
        </div>
        <hr>
        <div class="grid grid-cols-2 gap-4">
          <p class="font-bold col-span-2">References</p>
          @for (i of [0, 1, 2, 3, 4, 5, 6, 7, 8]; track i) {
            <app-external-link 
              class="col-span-1"
              [linkItem]="{ 
                url: ec['uniprots'][0]['structure_url'], 
                label: 'Structure'
              }"
            ></app-external-link>
          }
        </div>

      </div>
      <div class="grid grid-cols-2 gap-2 w-2/3 p-2 grid-rows-[auto,1fr]">
        <p class="col-span-1 col-start-1 font-bold">Reaction Schema</p>
        <p class="col-start-2 col-span-1 font-bold">Representative Structure</p>

        <div class="col-span-1 col-start-1 w-full h-full rounded-md border border-solid border-[#DEE2E6] p-2">
          <p>{{ ec['reaction'][0] }}</p>
        </div>
        <app-molecule3d 
          class="col-start-2 col-span-1 w-full h-full rounded-md border border-solid border-[#DEE2E6] p-1" 
          [options]="{
              data: ec['uniprots'][0]['uniprot_id'],
              dataType: 'uniprot',
              viewerOptions: {
                mode: 'cartoon',
                modeConfig: {
                  color: 'spectrum'
                }
              }
          }">
        </app-molecule3d>
      </div>
    </div>
    }
  </p-panel>

  <!-- Request Configuration -->
  <app-kinetic-table #kineticTable [result]="result" [filters]="filters"></app-kinetic-table>
</div>