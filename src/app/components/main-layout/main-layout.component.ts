import { Component, HostListener, ViewChild } from '@angular/core';
import { SidebarComponent, Tool } from '../sidebar/sidebar.component';
import { RouterOutlet } from '@angular/router';
import { ToolStatus } from '~/app/enums/tool-status';

@Component({
    selector: 'app-main-layout',
    templateUrl: './main-layout.component.html',
    styleUrls: ['./main-layout.component.scss'],
    host: {
      class: 'grow flex w-full h-full'
    },
    standalone: true,
    imports: [SidebarComponent, RouterOutlet]
})
export class MainLayoutComponent {
  @ViewChild('sidebar') sidebar!: SidebarComponent;
  private readonly COLLAPSE_BREAKPOINT = 1380;

  @HostListener('window:resize', ['$event'])
  onResize() {
    this.checkScreenSize();
  }

  ngOnInit() {
    this.checkScreenSize();
  }

  get sidebarCollapsed() {
    return this.sidebar.collapsed;
  }

  sidebarTools: Tool[] = [
    {
      id: 'query',
      name: 'Database Search',
      route: '/query',
      status: ToolStatus.RUNNING,
      icon: 'pi pi-search',
    },
    {
      id: 'property-prediction',
      name: 'Enzyme Property Prediction',
      route: '/property-prediction',
      status: ToolStatus.RUNNING,
      svgGenerator: this.getEnzymePropertyPredictionSVG,
    },
    {
      id: 'enzyme-recommendation',
      name: 'Enzyme Recommendation',
      route: '/enzyme-recommendation',
      status: ToolStatus.RUNNING,
      svgGenerator: this.getEnzymeRecommendationSVG,
    },
    // Add more tools here, potentially with different group names
  ];

  getEnzymePropertyPredictionSVG(fill: string): string {
    return `
    <svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g clip-path="url(#clip0_1237_34771)">
    <path d="M10.809 10.7467C10.3127 11.3124 9.70838 11.7752 9.02824 12.1108V14.0394C9.02824 14.2099 8.96051 14.3734 8.83995 14.494C8.71939 14.6145 8.55588 14.6822 8.38538 14.6822H4.52824C4.35774 14.6822 4.19423 14.6145 4.07367 14.494C3.95311 14.3734 3.88538 14.2099 3.88538 14.0394V12.1108C2.53068 11.4346 1.49503 10.2543 1.00068 8.82321C0.506324 7.39211 0.59266 5.82424 1.24116 4.45607C1.88966 3.0879 3.04864 2.02845 4.46939 1.50508C5.89014 0.981717 7.45944 1.03614 8.84052 1.65667M3.88538 17.8567H9.02824" stroke="${fill}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M9.51034 5.55754C9.05905 5.47911 9.05905 4.83111 9.51034 4.75268C10.3094 4.61361 11.0489 4.23974 11.6347 3.67873C12.2204 3.11772 12.6258 2.39499 12.7992 1.60268L12.8262 1.47668C12.9239 1.03054 13.5591 1.02797 13.6606 1.47283L13.6941 1.61811C13.8741 2.40684 14.2832 3.12478 14.8699 3.68178C15.4567 4.23878 16.1949 4.61 16.9919 4.74883C17.4458 4.82854 17.4458 5.47911 16.9919 5.55883C16.1951 5.69788 15.4572 6.06921 14.8707 6.62619C14.2842 7.18317 13.8753 7.90099 13.6953 8.68954L13.6619 8.83483C13.5603 9.27968 12.9252 9.27711 12.8275 8.83097L12.8018 8.70626C12.6282 7.91359 12.2224 7.19061 11.6362 6.62957C11.05 6.06852 10.3099 5.69614 9.51034 5.55754Z" stroke="${fill}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </g>
    <defs>
    <clipPath id="clip0_1237_34771">
    <rect width="18" height="18" transform="translate(0 0.5)"/>
    </clipPath>
    </defs>
    </svg>
    `;
  }

  getEnzymeRecommendationSVG(fill: string): string {
    return `
    <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M14.2503 10.5C15.2295 10.4999 16.182 10.1803 16.9632 9.58978C17.7444 8.99926 18.3117 8.17003 18.5789 7.22792C18.8461 6.2858 18.7987 5.28224 18.4439 4.3695C18.089 3.45677 17.4462 2.6847 16.6128 2.17044C15.7794 1.65618 14.801 1.42781 13.8261 1.51998C12.8512 1.61216 11.9329 2.01984 11.2107 2.68117C10.4884 3.3425 10.0017 4.22138 9.82417 5.18444C9.64669 6.1475 9.78821 7.14216 10.2273 8.01751L7.708 9.78976C7.32107 9.19216 6.75508 8.73223 6.09097 8.47573C5.42686 8.21924 4.69865 8.17932 4.01048 8.36168C3.32232 8.54404 2.70944 8.93934 2.2595 9.49105C1.80956 10.0428 1.54561 10.7226 1.50539 11.4334C1.46517 12.1442 1.65075 12.8495 2.03558 13.4484C2.42041 14.0474 2.98479 14.5093 3.64799 14.7681C4.3112 15.027 5.03926 15.0694 5.72807 14.8895C6.41687 14.7095 7.03113 14.3164 7.483 13.7663L11.3853 16.0425C11.1797 16.6562 11.2081 17.3242 11.465 17.9183C11.7219 18.5123 12.1892 18.9905 12.7772 19.261C13.3651 19.5315 14.0323 19.5753 14.6506 19.3839C15.2689 19.1925 15.7946 18.7794 16.1269 18.224C16.4592 17.6686 16.5746 17.01 16.4509 16.3747C16.3273 15.7394 15.9733 15.1722 15.4569 14.782C14.9405 14.3918 14.2982 14.2061 13.6533 14.2606C13.0084 14.3151 12.4063 14.6059 11.9628 15.0773L8.04325 12.7905C8.27272 12.1684 8.31342 11.4924 8.16025 10.8473L10.8543 8.95276C11.2762 9.43911 11.7979 9.82899 12.3839 10.096C12.9698 10.3629 13.6063 10.5007 14.2503 10.5ZM14.2503 9.37501C13.3551 9.37501 12.4967 9.01943 11.8638 8.38649C11.2308 7.75356 10.8753 6.89511 10.8753 6.00001C10.8753 5.1049 11.2308 4.24645 11.8638 3.61352C12.4967 2.98058 13.3551 2.62501 14.2503 2.62501C15.1454 2.62501 16.0038 2.98058 16.6367 3.61352C17.2697 4.24645 17.6253 5.1049 17.6253 6.00001C17.6253 6.89511 17.2697 7.75356 16.6367 8.38649C16.0038 9.01943 15.1454 9.37501 14.2503 9.37501ZM4.87525 13.875C4.27852 13.875 3.70622 13.638 3.28426 13.216C2.86231 12.794 2.62525 12.2217 2.62525 11.625C2.62525 11.0283 2.86231 10.456 3.28426 10.034C3.70622 9.61206 4.27852 9.37501 4.87525 9.37501C5.47199 9.37501 6.04429 9.61206 6.46624 10.034C6.8882 10.456 7.12525 11.0283 7.12525 11.625C7.12525 12.2217 6.8882 12.794 6.46624 13.216C6.04429 13.638 5.47199 13.875 4.87525 13.875ZM15.3753 16.875C15.3753 17.2728 15.2172 17.6544 14.9359 17.9357C14.6546 18.217 14.2731 18.375 13.8753 18.375C13.4774 18.375 13.0959 18.217 12.8146 17.9357C12.5333 17.6544 12.3753 17.2728 12.3753 16.875C12.3753 16.4772 12.5333 16.0956 12.8146 15.8143C13.0959 15.533 13.4774 15.375 13.8753 15.375C14.2731 15.375 14.6546 15.533 14.9359 15.8143C15.2172 16.0956 15.3753 16.4772 15.3753 16.875Z" fill="${fill}"/>
    </svg>
    `
  }

  private checkScreenSize() {
    let shouldCollapse = window.innerWidth < this.COLLAPSE_BREAKPOINT;
    if (this.sidebar) {
      this.sidebar.collapsed = shouldCollapse;
    }
  }
}
