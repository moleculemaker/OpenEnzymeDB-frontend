<p-dialog 
    [(visible)]="visible" 
    [modal]="true" 
    styleClass="w-[800px] h-[800px]"
    (onHide)="visibleChange.emit(false)"
>
    <ng-template pTemplate="header">
        <div class="flex items-center gap-2 font-semibold">
            Enzyme Structure
        </div>
    </ng-template>
    <div class="mx-4 h-full flex flex-col gap-4">
        <!-- Dropdowns Row -->
        <div class="flex flex-row gap-4 mt-4">
            <div class="flex flex-col w-1/3">
                <label class="mb-1 font-medium">Compound</label>
                <app-filter [filter]="compoundFilter" (filterChange)="onCompoundFilterChange()"></app-filter>
            </div>
            <div class="flex flex-col w-1/3">
                <label class="mb-1 font-medium">Organism</label>
                <app-filter [filter]="organismFilter" (filterChange)="onOrganismFilterChange()"></app-filter>
            </div>
            <div class="flex flex-col w-1/3">
                <label class="mb-1 font-medium">Uniprot ID</label>
                <app-filter [filter]="uniprotIdFilter"></app-filter>
            </div>
        </div>
        <!-- 3D Structure Viewer -->
        <div class="flex flex-wrap gap-4 mt-4">
            @for (id of getUniprotIds(); track id) {
                <div class="relative p-1 border border-solid border-[#DEE2E6] rounded-md" style="flex: 1 1 calc(33.333% - 1rem); min-width: calc(33.333% - 1rem);">
                    <div class="absolute top-1 left-1 font-semibold z-[10]">{{id}}</div>
                    <app-molecule3d
                        class="w-full h-[300px]"
                        [options]="{
                            data: id,
                            dataType: 'uniprot',
                            viewerOptions: {
                                mode: 'cartoon',
                                modeConfig: { color: 'spectrum' }
                            }
                        }"
                    ></app-molecule3d>
                </div>
            }
        </div>
    </div>
</p-dialog>